var l=Object.defineProperty;var B=(e,t,r)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var c=(e,t,r)=>(B(e,typeof t!="symbol"?t+"":t,r),r);import{C as g,E as s,G as h,D as p,B as i,I as C}from"./index-3efbb394.js";let D;const k=()=>{D=g.service({fullscreen:!0,lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"})},b=()=>{D.close()};let a=0;const S=()=>{a===0&&k(),a++},n=()=>{a<=0||(a--,a===0&&b())};var o=(e=>(e[e.SUCCESS=200]="SUCCESS",e[e.ERROR=500]="ERROR",e[e.OVERDUE=599]="OVERDUE",e[e.TIMEOUT=3e4]="TIMEOUT",e.TYPE="success",e))(o||{}),U=(e=>(e.JSON="application/json;charset=UTF-8",e.TEXT="text/plain;charset=UTF-8",e.FORM_URLENCODED="application/x-www-form-urlencoded;charset=UTF-8",e.FORM_DATA="multipart/form-data;charset=UTF-8",e))(U||{});const v=e=>{switch(e){case 400:s.error("\u8BF7\u6C42\u5931\u8D25\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5");break;case 401:s.error("\u767B\u5F55\u5931\u6548\uFF01\u8BF7\u60A8\u91CD\u65B0\u767B\u5F55");break;case 403:s.error("\u5F53\u524D\u8D26\u53F7\u65E0\u6743\u9650\u8BBF\u95EE\uFF01");break;case 404:s.error("\u4F60\u6240\u8BBF\u95EE\u7684\u8D44\u6E90\u4E0D\u5B58\u5728\uFF01");break;case 405:s.error("\u8BF7\u6C42\u65B9\u5F0F\u9519\u8BEF\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5");break;case 408:s.error("\u8BF7\u6C42\u8D85\u65F6\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5");break;case 500:s.error("\u670D\u52A1\u5F02\u5E38\uFF01");break;case 502:s.error("\u7F51\u5173\u9519\u8BEF\uFF01");break;case 503:s.error("\u670D\u52A1\u4E0D\u53EF\u7528\uFF01");break;case 504:s.error("\u7F51\u5173\u8D85\u65F6\uFF01");break;default:s.error("\u8BF7\u6C42\u5931\u8D25\uFF01")}},F=h(),d=new C,f={baseURL:"/api",timeout:o.TIMEOUT,withCredentials:!0};class A{constructor(t){c(this,"service");this.service=p.create(t),this.service.interceptors.request.use(r=>{d.addPending(r),r.headers.noLoading||S();const u=F.token;return{...r,headers:{"x-access-token":u}}},r=>Promise.reject(r)),this.service.interceptors.response.use(r=>{const{data:u,config:E}=r;return d.removePending(E),n(),u.code==o.OVERDUE?(s.error(u.msg),F.setToken(""),i.replace({path:"/login"}),Promise.reject(u)):u.code&&u.code!==o.SUCCESS?(s.error(u.msg),Promise.reject(u)):u},async r=>{const{response:u}=r;return n(),u?v(u.status):window.navigator.onLine?Promise.reject(r):i.replace({path:"/500"})})}get(t,r,u={}){return this.service.get(t,{params:r,...u})}post(t,r,u={}){return this.service.post(t,r,u)}put(t,r,u={}){return this.service.put(t,r,u)}delete(t,r,u={}){return this.service.delete(t,{params:r,...u})}}var L=new A(f);export{U as C,L as h};
